<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyats &mdash; pyats 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Information about ATS" href="info.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> pyats
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="info.html">Information about ATS</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">pyats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyats.ats_io">ats_io</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats.ats_io.ATS_MAGIC_NUMBER"><code class="docutils literal notranslate"><span class="pre">ATS_MAGIC_NUMBER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.ats_io.ats_load"><code class="docutils literal notranslate"><span class="pre">ats_load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.ats_io.ats_save"><code class="docutils literal notranslate"><span class="pre">ats_save()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyats.ats_structure">ats_structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats.ats_structure.AtsPeak"><code class="docutils literal notranslate"><span class="pre">AtsPeak</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyats.ats_structure.AtsPeak.clone"><code class="docutils literal notranslate"><span class="pre">AtsPeak.clone()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.ats_structure.AtsSound"><code class="docutils literal notranslate"><span class="pre">AtsSound</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyats.ats_structure.AtsSound.TODO"><code class="docutils literal notranslate"><span class="pre">AtsSound.TODO</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyats.ats_structure.AtsSound.clone"><code class="docutils literal notranslate"><span class="pre">AtsSound.clone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyats.ats_structure.AtsSound.optimize"><code class="docutils literal notranslate"><span class="pre">AtsSound.optimize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyats.ats_synth">ats_synth</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats.ats_synth.synth"><code class="docutils literal notranslate"><span class="pre">synth()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.ats_synth.synth_CLI"><code class="docutils literal notranslate"><span class="pre">synth_CLI()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#pyats-atsa">pyats.atsa</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyats.atsa.critical_bands">critical_bands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES"><code class="docutils literal notranslate"><span class="pre">ATS_CRITICAL_BAND_EDGES</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.critical_bands.compute_slope_r"><code class="docutils literal notranslate"><span class="pre">compute_slope_r()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.critical_bands.evaluate_smr"><code class="docutils literal notranslate"><span class="pre">evaluate_smr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.critical_bands.find_band"><code class="docutils literal notranslate"><span class="pre">find_band()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.critical_bands.frq_to_bark"><code class="docutils literal notranslate"><span class="pre">frq_to_bark()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyats.atsa.peak_detect">peak_detect</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_detect.parabolic_interp"><code class="docutils literal notranslate"><span class="pre">parabolic_interp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_detect.peak_detection"><code class="docutils literal notranslate"><span class="pre">peak_detection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_detect.phase_correct"><code class="docutils literal notranslate"><span class="pre">phase_correct()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyats.atsa.peak_tracking">peak_tracking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_tracking.MatchCost"><code class="docutils literal notranslate"><span class="pre">MatchCost</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyats.atsa.peak_tracking.MatchCost.cost"><code class="docutils literal notranslate"><span class="pre">MatchCost.cost</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyats.atsa.peak_tracking.MatchCost.index"><code class="docutils literal notranslate"><span class="pre">MatchCost.index</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_tracking.are_valid_candidates"><code class="docutils literal notranslate"><span class="pre">are_valid_candidates()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_tracking.find_track_in_peaks"><code class="docutils literal notranslate"><span class="pre">find_track_in_peaks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_tracking.peak_dist"><code class="docutils literal notranslate"><span class="pre">peak_dist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_tracking.peak_tracking"><code class="docutils literal notranslate"><span class="pre">peak_tracking()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_tracking.phase_interp"><code class="docutils literal notranslate"><span class="pre">phase_interp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_tracking.phase_interp_cubic"><code class="docutils literal notranslate"><span class="pre">phase_interp_cubic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.peak_tracking.update_track_averages"><code class="docutils literal notranslate"><span class="pre">update_track_averages()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyats.atsa.residual">residual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.residual.band_to_energy"><code class="docutils literal notranslate"><span class="pre">band_to_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.residual.compute_residual"><code class="docutils literal notranslate"><span class="pre">compute_residual()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.residual.remove_bands"><code class="docutils literal notranslate"><span class="pre">remove_bands()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.residual.residual_N"><code class="docutils literal notranslate"><span class="pre">residual_N()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.residual.residual_analysis"><code class="docutils literal notranslate"><span class="pre">residual_analysis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.residual.residual_compute_band_energy"><code class="docutils literal notranslate"><span class="pre">residual_compute_band_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.residual.residual_get_band_limits"><code class="docutils literal notranslate"><span class="pre">residual_get_band_limits()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyats.atsa.tracker">tracker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.tracker.tracker"><code class="docutils literal notranslate"><span class="pre">tracker()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.tracker.tracker_CLI"><code class="docutils literal notranslate"><span class="pre">tracker_CLI()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyats.atsa.utils">utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.utils.MAX_DB_SPL"><code class="docutils literal notranslate"><span class="pre">MAX_DB_SPL</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.utils.ATS_MIN_SEGMENT_LENGTH"><code class="docutils literal notranslate"><span class="pre">ATS_MIN_SEGMENT_LENGTH</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.utils.ATS_AMP_THRESHOLD"><code class="docutils literal notranslate"><span class="pre">ATS_AMP_THRESHOLD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.utils.ATS_NOISE_THRESHOLD"><code class="docutils literal notranslate"><span class="pre">ATS_NOISE_THRESHOLD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.utils.amp_to_db"><code class="docutils literal notranslate"><span class="pre">amp_to_db()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.utils.amp_to_db_spl"><code class="docutils literal notranslate"><span class="pre">amp_to_db_spl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.utils.compute_frames"><code class="docutils literal notranslate"><span class="pre">compute_frames()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.utils.db_to_amp"><code class="docutils literal notranslate"><span class="pre">db_to_amp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.utils.next_power_of_2"><code class="docutils literal notranslate"><span class="pre">next_power_of_2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.utils.optimize_tracks"><code class="docutils literal notranslate"><span class="pre">optimize_tracks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyats.atsa.windows">windows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.windows.VALID_FFT_WINDOW_DEFINITIONS"><code class="docutils literal notranslate"><span class="pre">VALID_FFT_WINDOW_DEFINITIONS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.windows.ATS_BLACKMAN_WINDOW_COEFF_LABELS"><code class="docutils literal notranslate"><span class="pre">ATS_BLACKMAN_WINDOW_COEFF_LABELS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.windows.bes_i0"><code class="docutils literal notranslate"><span class="pre">bes_i0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.windows.make_blackman_window"><code class="docutils literal notranslate"><span class="pre">make_blackman_window()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.windows.make_fft_window"><code class="docutils literal notranslate"><span class="pre">make_fft_window()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.windows.normalize_window"><code class="docutils literal notranslate"><span class="pre">normalize_window()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyats.atsa.windows.window_norm"><code class="docutils literal notranslate"><span class="pre">window_norm()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyats</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">pyats</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pyats.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pyats">
<h1>pyats<a class="headerlink" href="#pyats" title="Permalink to this heading"></a></h1>
<section id="module-pyats.ats_io">
<span id="ats-io"></span><h2>ats_io<a class="headerlink" href="#module-pyats.ats_io" title="Permalink to this heading"></a></h2>
<p>ATS File I/O</p>
<p>Functions for handling loading and saving of .ats files.</p>
<p>.ats files are written in binary format using double floats.</p>
<p>The expected structure of a .ats is:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ATS Header (all double floats)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#pyats.ats_io.ATS_MAGIC_NUMBER" title="pyats.ats_io.ATS_MAGIC_NUMBER"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ATS_MAGIC_NUMBER</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>sampling-rate (samples/sec)</p></td>
</tr>
<tr class="row-even"><td><p>frame-size (samples)</p></td>
</tr>
<tr class="row-odd"><td><p>window-size (samples)</p></td>
</tr>
<tr class="row-even"><td><p>partials (number)</p></td>
</tr>
<tr class="row-odd"><td><p>frames (number)</p></td>
</tr>
<tr class="row-even"><td><p>ampmax (max. amplitude)</p></td>
</tr>
<tr class="row-odd"><td><p>frqmax (max. frequency)</p></td>
</tr>
<tr class="row-even"><td><p>dur (duration)</p></td>
</tr>
<tr class="row-odd"><td><p>type (# specifying frame type, see below)</p></td>
</tr>
</tbody>
</table>
<p>The frame data immediately follows the header,
again all double floats, frame by frame, with a
format matching the <cite>type</cite> (int) as specified in the header</p>
<p>ATS frames can be one of four different types:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>TYPE 1: NO phase &amp; NO noise</p></th>
<th class="head"><p>TYPE 2: WITH phase &amp; NO noise</p></th>
<th class="head"><p>TYPE 3: NO phase &amp; WITH noise</p></th>
<th class="head"><p>TYPE 4: WITH phase &amp; WITH noise</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>time (frame starting time)</p></td>
<td><p>time (frame starting time)</p></td>
<td><p>time (frame starting time)</p></td>
<td><p>time (frame starting time)</p></td>
</tr>
<tr class="row-odd"><td><p>amp (partial #0 amplitude)</p></td>
<td><p>amp (partial #0 amplitude)</p></td>
<td><p>amp (partial #0 amplitude)</p></td>
<td><p>amp (partial #0 amplitude)</p></td>
</tr>
<tr class="row-even"><td><p>frq (partial #0 frequency)</p></td>
<td><p>frq (partial #0 frequency)</p></td>
<td><p>frq (partial #0 frequency)</p></td>
<td><p>frq (partial #0 frequency)</p></td>
</tr>
<tr class="row-odd"><td><p>…</p></td>
<td><p>pha (partial #0 phase)</p></td>
<td><p>…</p></td>
<td><p>pha (partial #0 phase)</p></td>
</tr>
<tr class="row-even"><td><p>amp (partial #n amplitude)</p></td>
<td><p>…</p></td>
<td><p>amp (partial #n amplitude)</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>frq (partial #n frequency)</p></td>
<td><p>amp (partial #n amplitude)</p></td>
<td><p>frq (partial #n frequency)</p></td>
<td><p>amp (partial #n amplitude)</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>frq (partial #n frequency)</p></td>
<td><p>noise (band #0 energy)</p></td>
<td><p>frq (partial #n frequency)</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>pha (partial #n phase)</p></td>
<td><p>…</p></td>
<td><p>pha (partial #n phase)</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>noise (band #n energy)</p></td>
<td><p>noise (band #0 energy)</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td><p>noise (band #n energy)</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.ats_io.ATS_MAGIC_NUMBER">
<span class="sig-prename descclassname"><span class="pre">pyats.ats_io.</span></span><span class="sig-name descname"><span class="pre">ATS_MAGIC_NUMBER</span></span><a class="headerlink" href="#pyats.ats_io.ATS_MAGIC_NUMBER" title="Permalink to this definition"></a></dt>
<dd><p>‘magic’ number used to validate and check endianness when using .ats files: 123.0</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.ats_io.ats_load">
<span class="sig-prename descclassname"><span class="pre">pyats.ats_io.</span></span><span class="sig-name descname"><span class="pre">ats_load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_gap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_segment_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highest_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowest_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/ats_io.html#ats_load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.ats_io.ats_load" title="Permalink to this definition"></a></dt>
<dd><p>Function to load a .ats file into python</p>
<p>Loads a .ats file into python and provides routines to re-optimize the
<a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a> data if required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name used for labeling <a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a></p></li>
<li><p><strong>file</strong> (<em>str</em>) – filepath to .ats file to load</p></li>
<li><p><strong>optimize</strong> (<em>bool</em><em>, </em><em>optional</em>) – determined whether to call <a class="reference internal" href="#pyats.ats_structure.AtsSound.optimize" title="pyats.ats_structure.AtsSound.optimize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optimize</span></code></a> upon load (default: True)</p></li>
<li><p><strong>min_gap_size</strong> (<em>int</em><em>, </em><em>optional</em>) – when optimizing, tracked partial gaps smaller than or equal to this (in frames) will be
interpolated and filled. If None, no gap filling will occur (default: None)</p></li>
<li><p><strong>amp_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum amplitude threshold used during optimization to prune tracks.
If None, no amplitude thresholding will occur (default: None)</p></li>
<li><p><strong>highest_frequency</strong> (<em>float</em><em>, </em><em>optional</em>) – maximum frequency threshold used during optimization to prune tracks.
If None, no maximum frequency thresholding will occur (default: None)</p></li>
<li><p><strong>lowest_frequency</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum frequency threshold used during optimization to prune tracks.
If None, no minimum frequency thresholding will occur (default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the loaded ats data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if file is not a compatible ATS format (i.e., the ATS magic number was not decodable)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.ats_io.ats_save">
<span class="sig-prename descclassname"><span class="pre">pyats.ats_io.</span></span><span class="sig-name descname"><span class="pre">ats_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/ats_io.html#ats_save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.ats_io.ats_save" title="Permalink to this definition"></a></dt>
<dd><p>Function to save an <a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a> to a file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sound</strong> (<a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a>) – ats sound object to save</p></li>
<li><p><strong>file</strong> (<em>str</em>) – file path to save to</p></li>
<li><p><strong>save_phase</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to include phase data in file output (default: True)</p></li>
<li><p><strong>save_noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to include noise band energy data in file output (default: True)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyats.ats_structure">
<span id="ats-structure"></span><h2>ats_structure<a class="headerlink" href="#module-pyats.ats_structure" title="Permalink to this heading"></a></h2>
<p>Data Abstraction for ATS</p>
<p>TODO About</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyats.ats_structure.AtsPeak">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyats.ats_structure.</span></span><span class="sig-name descname"><span class="pre">AtsPeak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_spl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">barkfrq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asleep_for</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/ats_structure.html#AtsPeak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.ats_structure.AtsPeak" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>TODO
.. attribute:: TODO</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyats.ats_structure.AtsPeak.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/ats_structure.html#AtsPeak.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.ats_structure.AtsPeak.clone" title="Permalink to this definition"></a></dt>
<dd><p>Function to return a copy of an <a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a copy of the calling <a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a> object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyats.ats_structure.AtsSound">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyats.ats_structure.</span></span><span class="sig-name descname"><span class="pre">AtsSound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/ats_structure.html#AtsSound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.ats_structure.AtsSound" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>TODO
main data abstraction
amp, frq, and pha contain sinusoidal modeling information as arrays of
arrays of data arranged by partial par-energy and band-energy hold
noise modeling information (experimental format)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.ats_structure.AtsSound.TODO">
<span class="sig-name descname"><span class="pre">TODO</span></span><a class="headerlink" href="#pyats.ats_structure.AtsSound.TODO" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyats.ats_structure.AtsSound.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/ats_structure.html#AtsSound.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.ats_structure.AtsSound.clone" title="Permalink to this definition"></a></dt>
<dd><p>Function to return a deep copy of an <a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a deep copy of the calling <a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a> object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyats.ats_structure.AtsSound.optimize">
<span class="sig-name descname"><span class="pre">optimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_gap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_segment_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highest_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowest_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/ats_structure.html#AtsSound.optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.ats_structure.AtsSound.optimize" title="Permalink to this definition"></a></dt>
<dd><p>Function to run optimization routines on the frames of partial data stored in the object.</p>
<dl class="simple">
<dt>The optimizations performed are:</dt><dd><ul class="simple">
<li><p>fill gaps of min_gap_size or shorter</p></li>
<li><p>trim short partials</p></li>
<li><p>calculate and store maximum and average frq and amp</p></li>
<li><p>prune partials below amplitude threshold</p></li>
<li><p>prune partials outside frequency constraints</p></li>
<li><p>re-order partials according to average frq</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_gap_size</strong> (<em>int</em><em>, </em><em>optional</em>) – partial gaps longer than this (in frames) will not be interpolated and filled in.
If None, this sub-optimization will be skipped.  (default: None)</p></li>
<li><p><strong>min_segment_length</strong> (<em>int</em><em>, </em><em>optional</em>) – minimal size (in frames) of a valid partial segment, otherwise it is pruned.
If None, this sub-optimization will be skipped. (default: None)</p></li>
<li><p><strong>amp_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – amplitude threshold used to prune partials.
If None, this sub-optimization will be skipped. (default: None)</p></li>
<li><p><strong>highest_frequency</strong> (<em>float</em>) – upper frequency threshold, tracks with maxima above this will be pruned.
If None, this sub-optimization will be skipped. (default: None)</p></li>
<li><p><strong>lowest_frequency</strong> (<em>float</em>) – lower frequency threshold, tracks with minima below this will be pruned.
If None, this sub-optimization will be skipped. (default: None)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyats.ats_synth">
<span id="ats-synth"></span><h2>ats_synth<a class="headerlink" href="#module-pyats.ats_synth" title="Permalink to this heading"></a></h2>
<p>Synthesizer Methods for Rendering .ats Files to Audio</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyats.ats_synth.synth">
<span class="sig-prename descclassname"><span class="pre">pyats.ats_synth.</span></span><span class="sig-name descname"><span class="pre">synth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ats_snd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sine_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_sine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/ats_synth.html#synth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.ats_synth.synth" title="Permalink to this definition"></a></dt>
<dd><p>Function to synthesize audio from <a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a></p>
<p>Sine generator bank and band-limited noise synthesizer for .ats files. When
phase information is ignored phase is linearly interpolated between consecutive
frequencies from an initial phase of 0.0 at the first non-zero amplitude for that partial.</p>
<p>The method for cubic polynomial interpolation of phase used is credited to:</p>
<blockquote>
<div><p>MR. McAulay and T. Quatieri, “Speech analysis/Synthesis based on a
sinusoidal representation,” in IEEE Transactions on Acoustics,
Speech, and Signal Processing, vol. 34, no. 4, pp. 744-754,
August 1986</p>
<p><a class="reference external" href="https://doi.org/10.1109/TASSP.1986.1164910">doi: 10.1109/TASSP.1986.1164910</a>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ats_snd</strong> (<a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a>) – the .ats file used to synthesize</p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>optional</em>) – normalize sound to ±1 before output (default: False)</p></li>
<li><p><strong>compute_phase</strong> (<em>bool</em><em>, </em><em>optional</em>) – use cubic polynomial interpolation of phase information during synthesis, if available (default: True)</p></li>
<li><p><strong>export_file</strong> (<em>str</em>) – audio file path to write synthesis to, or None for no file output (default: None)</p></li>
<li><p><strong>sine_pct</strong> (<em>float</em>) – percentage of sine components to mix into output (default: 1.0)</p></li>
<li><p><strong>noise_pct</strong> (<em>float</em>) – percentage of noise components to mix into output (default: 0.0)</p></li>
<li><p><strong>noise_bands</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – 1D array of band edges to use for noise analysis. Currently using other than 25 bands
(i.e. 26 edges) is not fully supported. If None,
<a class="reference internal" href="#pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES" title="pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ATS_CRITICAL_BAND_EDGES</span></code></a> will be used. (default: None)</p></li>
<li><p><strong>normalize_sine</strong> (<em>bool</em>) – normalize sine components to ±1 before mixing (default: False)</p></li>
<li><p><strong>normalize_noise</strong> (<em>bool</em>) – normalize noise componenets to ±1 before mixing (default: False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A 1D array of amplitudes representing the synthesized sound</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.ats_synth.synth_CLI">
<span class="sig-prename descclassname"><span class="pre">pyats.ats_synth.</span></span><span class="sig-name descname"><span class="pre">synth_CLI</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/ats_synth.html#synth_CLI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.ats_synth.synth_CLI" title="Permalink to this definition"></a></dt>
<dd><p>Command line wrapper for <a class="reference internal" href="#pyats.ats_synth.synth" title="pyats.ats_synth.synth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">synth</span></code></a></p>
<p class="rubric">Example</p>
<p>Display usage details with help flag</p>
<blockquote>
<div><p>$ pyats-synth -h</p>
</div></blockquote>
<p>Generate a wav file from a sine generator bank from an ats file</p>
<blockquote>
<div><p>$ pyats-synth example.ats example.wav</p>
</div></blockquote>
<p>Generate a wav file from a sine generator bank and band-limited noise using from an ats file</p>
<blockquote>
<div><p>$ pyats-synth example.ats example.wav –noise 1.0</p>
</div></blockquote>
</dd></dl>

</section>
</section>
<section id="pyats-atsa">
<h1>pyats.atsa<a class="headerlink" href="#pyats-atsa" title="Permalink to this heading"></a></h1>
<section id="module-pyats.atsa.critical_bands">
<span id="critical-bands"></span><h2>critical_bands<a class="headerlink" href="#module-pyats.atsa.critical_bands" title="Permalink to this heading"></a></h2>
<p>Critical Bands and Signal-to-Mask Ratio Evaluation</p>
<p>This module is used to evaluate critical band masking for signal-to-mask ratio calculations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.critical_bands.</span></span><span class="sig-name descname"><span class="pre">ATS_CRITICAL_BAND_EDGES</span></span><a class="headerlink" href="#pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES" title="Permalink to this definition"></a></dt>
<dd><p>1D array containing 26 frequencies that distinguish the default 25 critical bands</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.critical_bands.compute_slope_r">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.critical_bands.</span></span><span class="sig-name descname"><span class="pre">compute_slope_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">masker_amp_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-27.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/critical_bands.html#compute_slope_r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.critical_bands.compute_slope_r" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute right slope of triangular mask</p>
<p>Computes the right slope of mask, dependent on the level of the masker</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>masker_amp_db</strong> (<em>float</em>) – Amplitude (in dB) of the masker peak</p></li>
<li><p><strong>slope_l</strong> (<em>float</em><em>, </em><em>optional</em>) – slope (in dB / bark) of the lower frequency side of the masking triangle</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.critical_bands.evaluate_smr">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.critical_bands.</span></span><span class="sig-name descname"><span class="pre">evaluate_smr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-27.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_db</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/critical_bands.html#evaluate_smr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.critical_bands.evaluate_smr" title="Permalink to this definition"></a></dt>
<dd><p>Function to evaluate signal-to-mask ratio for the given peaks</p>
<p>This function evaluates masking values (SMR) for <code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak`s</span> <span class="pre">in</span> <span class="pre">list</span> <span class="pre">`peaks</span></code>
Iteratively the parameters will be use to generate a triangular mask
with a primary vertex at the frequency of, and at delta_dB below the amplitude
of the masker.</p>
<a class="reference internal image-reference" href="_images/smr.png"><img alt="graphic depiction of smr calculation" src="_images/smr.png" style="width: 350px;" /></a>
<p>All other peaks are evaluated based on the triangular
edges descending from the primary vertex according to slope_l for lower
frequencies, and a calculated slope for higher frequencies. Maskee amplitudes
proportions above this edge are then assigned to the maskee peak’s smr property.
By the end of the iteration, the largest smr seen as maskee is kept in the peak’s
smr property.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (Iterable[<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>]) – An iterable collection of AtsPeaks that will have their <cite>smr</cite> attributes updated</p></li>
<li><p><strong>slope_l</strong> (<em>float</em><em>, </em><em>optional</em>) – A float (in dB/bark) to dictate the slope of the left side of the mask (default: -27.0)</p></li>
<li><p><strong>delta_db</strong> (<em>float</em><em>, </em><em>optional</em>) – A float (in dB) that sets the amplitude threshold for the masking curves
Must be (&lt;= 0dB) (default: -50)</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>delta_db</cite> is not less than or equal to 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.critical_bands.find_band">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.critical_bands.</span></span><span class="sig-name descname"><span class="pre">find_band</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/critical_bands.html#find_band"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.critical_bands.find_band" title="Permalink to this definition"></a></dt>
<dd><p>Function to retrieve lower band edge in <a class="reference internal" href="#pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES" title="pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ATS_CRITICAL_BAND_EDGES</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>freq</strong> (<em>float</em>) – A frequency (in Hz) to find the related band in <a class="reference internal" href="#pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES" title="pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ATS_CRITICAL_BAND_EDGES</span></code></a> for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>index into <a class="reference internal" href="#pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES" title="pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ATS_CRITICAL_BAND_EDGES</span></code></a> that marks the lower band edge for the given freq</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>LookupError</strong> – if the frequency given is outside the range of the lowest or highest edge in <a class="reference internal" href="#pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES" title="pyats.atsa.critical_bands.ATS_CRITICAL_BAND_EDGES"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ATS_CRITICAL_BAND_EDGES</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.critical_bands.frq_to_bark">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.critical_bands.</span></span><span class="sig-name descname"><span class="pre">frq_to_bark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/critical_bands.html#frq_to_bark"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.critical_bands.frq_to_bark" title="Permalink to this definition"></a></dt>
<dd><p>Function to convert frequency from Hz to bark scale</p>
<p>This function will convert frequency from Hz to bark scale, a psychoacoustical scale used
for subjective measurements of loudness.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>freq</strong> (<em>float</em>) – A frequency (in Hz) to convert to bark scale</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the frequency in bark scale</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyats.atsa.peak_detect">
<span id="peak-detect"></span><h2>peak_detect<a class="headerlink" href="#module-pyats.atsa.peak_detect" title="Permalink to this heading"></a></h2>
<p>Single-Frame Peak Detection from FFT Data</p>
<p>Functions to process FFT data and extract peaks</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.peak_detect.parabolic_interp">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_detect.</span></span><span class="sig-name descname"><span class="pre">parabolic_interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_detect.html#parabolic_interp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_detect.parabolic_interp" title="Permalink to this definition"></a></dt>
<dd><p>Function to obtain a parabolically modeled maximum from 3 points</p>
<p>Given 3 evenly-spaced points, a parabolic interpolation
scheme is used to calculate a coordinate frequency offset
and maximum amplitude at the estimated parabolic apex.</p>
<p>Expected: <cite>alpha</cite> &lt;= <cite>beta</cite> &lt;= <cite>gamma</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<em>float</em>) – Amplitude at lower frequency</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Amplitude at center frequency</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – Amplitude at upper frequency</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>offset</strong> (<em>float</em>) – Frequency offset (in samples) relative to center frequency bin</p></li>
<li><p><strong>height</strong> (<em>float</em>) – Amplitude of estimated parabolic apex</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.peak_detect.peak_detection">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_detect.</span></span><span class="sig-name descname"><span class="pre">peak_detection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fftfreqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fftmags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fftphases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowest_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highest_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowest_magnitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_detect.html#peak_detection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_detect.peak_detection" title="Permalink to this definition"></a></dt>
<dd><p>Function to detect peaks from FFT data</p>
<p>This function scans for peaks in FFT frequency data,
returning found peaks that pass constraint criteria.
Because FFT data is restricted to discrete bins, interpolation
is used to provide a more precise estimation of amplitude, phase, and frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fftfreqs</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – A 1D array of frequency labels (in Hz) corresponding to <cite>fftmags</cite> and <cite>fftphases</cite></p></li>
<li><p><strong>fftmags</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – A 1D array of FFT magnitudes for each frequency in <cite>fftfreqs</cite>; this is the data where we search for the peaks.</p></li>
<li><p><strong>fftphases</strong> (<em>ndarray</em><em>[</em><em>float64</em><em>]</em>) – A 1D array of FFT phases (in radians) for each index in <cite>fftfreqs</cite> and <cite>fftmags</cite></p></li>
<li><p><strong>lowest_bin</strong> (<em>int</em><em>, </em><em>optional</em>) – Lower limit bin index used to restrict what bins of <cite>fftfreqs</cite> are searched (default: None)</p></li>
<li><p><strong>highest_bin</strong> (<em>int</em><em>, </em><em>optional</em>) – Upper limit bin index used to restrict what bins of <cite>fftfreqs</cite> are searched (default: None)</p></li>
<li><p><strong>lowest_magnitude</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum amplitude threshold that must be exceeded for a peak to validly detected (default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of <a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a> constructed from detected peaks</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list[<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.peak_detect.phase_correct">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_detect.</span></span><span class="sig-name descname"><span class="pre">phase_correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_detect.html#phase_correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_detect.phase_correct" title="Permalink to this definition"></a></dt>
<dd><p>Function for angular interpolation of phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left</strong> (<em>float</em>) – Phase value (in radians) to interpolate between</p></li>
<li><p><strong>right</strong> (<em>float</em>) – Other phase value (in radians) to interpolate between</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – Phase offset (in samples) between left and right at which to calculate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>interpolated phase (in radians)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyats.atsa.peak_tracking">
<span id="peak-tracking"></span><h2>peak_tracking<a class="headerlink" href="#module-pyats.atsa.peak_tracking" title="Permalink to this heading"></a></h2>
<p>Peak Tracking algorithms to assemble spectral trajectories</p>
<p>Peaks issued by the peak detection algorithm need to be connected and
translated into spectral trajectories. This process involves the evaluation
of the possible candidates to continue trajectories on a frame-by-frame basis.</p>
<p>This is done using tracks that keep information of recent average values for each
of the trajectory parameters. The length of the tracks is adjustable and has to
be tuned depending on the characteristics of the analyzed sound.</p>
<p>A Gale-Shapley stable matching algorithm is used to determine the best candidate pair using a the cost criteria:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(cost = \frac{|P_{freq} - T_{freq}| + \alpha * |P_{smr} - T_{smr}|}{1 + \alpha}\)</span></p>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(P_{freq}\)</span> is the candidate peak frequency, and <span class="math notranslate nohighlight">\(P_{smr}\)</span> its SMR, <span class="math notranslate nohighlight">\(T_{freq}\)</span>
is the track frequency, and <span class="math notranslate nohighlight">\(T_{smr}\)</span> its SMR, both averaged over the track length (typically 3 frames).
<span class="math notranslate nohighlight">\(\alpha\)</span> is a coefficient controlling how much the SMR deviation affects the cost.</p>
<p>The use of the SMR continuation as a parameter for the peak tracking process is based upon
psychoacoustic temporal masking phenomena. Conceptually, we assume that masking profiles of
stable sinusoidal trajectories can only evolve at slow rate (no sudden changes). This is true for
analysis performed with hop sizes between 10 and 50 milliseconds, which is comparable to the
average duration of pre- and post-making effects.</p>
<p>New tracks get created from orphan peaks (the ones that were not incorporated to any existing tracks),
and tracks which couldn’t find continuing peaks are set to sleep.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyats.atsa.peak_tracking.MatchCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_tracking.</span></span><span class="sig-name descname"><span class="pre">MatchCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_tracking.html#MatchCost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_tracking.MatchCost" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Object to abstract cost for comparisons</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.atsa.peak_tracking.MatchCost.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><a class="headerlink" href="#pyats.atsa.peak_tracking.MatchCost.cost" title="Permalink to this definition"></a></dt>
<dd><p>the calculated cost to <cite>index</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.atsa.peak_tracking.MatchCost.index">
<span class="sig-name descname"><span class="pre">index</span></span><a class="headerlink" href="#pyats.atsa.peak_tracking.MatchCost.index" title="Permalink to this definition"></a></dt>
<dd><p>the index that indicates the track the cost was calculated against</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.peak_tracking.are_valid_candidates">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_tracking.</span></span><span class="sig-name descname"><span class="pre">are_valid_candidates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidate1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidate2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deviation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_tracking.html#are_valid_candidates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_tracking.are_valid_candidates" title="Permalink to this definition"></a></dt>
<dd><p>Function to determine if the distance between two peaks are within the relative deviation constraint</p>
<p>Peaks are valid candidates for pair if their absolute distance is smaller than the frequency deviation
multiplied by the lower of the candidate’s frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>candidate1</strong> (<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>) – a candidate peak</p></li>
<li><p><strong>candidate2</strong> (<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>) – a candidate peak</p></li>
<li><p><strong>deviation</strong> (<em>float</em>) – relative frequency deviation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the candidates are within constrained range, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.peak_tracking.find_track_in_peaks">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_tracking.</span></span><span class="sig-name descname"><span class="pre">find_track_in_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">track</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_tracking.html#find_track_in_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_tracking.find_track_in_peaks" title="Permalink to this definition"></a></dt>
<dd><p>Function to search a the first peak found tagged a given track ind</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>track</strong> (<em>int</em>) – the track index to search for</p></li>
<li><p><strong>peaks</strong> (Iterable[<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>]) – a collection of <a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a> to search in</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the first <a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a> found in <cite>peaks</cite> that has a .track attribute matching <cite>track</cite>.
If no matches are found, None is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.peak_tracking.peak_dist">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_tracking.</span></span><span class="sig-name descname"><span class="pre">peak_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pk1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pk2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_tracking.html#peak_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_tracking.peak_dist" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate peak frequency distance</p>
<p>This function is used to calculate the cost for the peak matching algorithm
and allows for psychoacoustic biasing of the calculation:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(dist = \frac{|P1_{freq} - P2_{freq}| + \alpha * |P1_{smr} - P2_{smr}|}{1 + \alpha}\)</span></p>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(P\#_{freq}\)</span> is the peak’s frequency, and <span class="math notranslate nohighlight">\(P\#_{smr}\)</span> its SMR.
<span class="math notranslate nohighlight">\(\alpha\)</span> is a coefficient controlling how much the SMR deviation affects the distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pk1</strong> (<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>) – a candidate peak</p></li>
<li><p><strong>pk1</strong> – a candidate peak</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – percent of SMR to use to bias the result</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the frequency distance (in Hz) between the peaks</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.peak_tracking.peak_tracking">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_tracking.</span></span><span class="sig-name descname"><span class="pre">peak_tracking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analysis_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency_deviation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SMR_continuity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_gap_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_tracking.html#peak_tracking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_tracking.peak_tracking" title="Permalink to this definition"></a></dt>
<dd><p>Core function to coordinate peak tracking</p>
<p>This function coordinates the matching of new peaks with existing tracks using
an adaptation of the Gale-Shapley algorithm for stable matching. The algorithm is
gap-size aware and will monitor ‘slept’ tracks within the minimum gap distance as
candidates. Linear interpolation is used to fill the gaps for frequency and amplitude,
and a cubic polynomial interpolation for phase.</p>
<p>NOTE: Tracks, peaks, and analysis_frames are updated directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracks</strong> (Iterable[<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>]) – collection of established tracks</p></li>
<li><p><strong>peaks</strong> (Iterable[<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>]) – collection of candidate peaks to match</p></li>
<li><p><strong>frame_n</strong> (<em>int</em>) – the current frame</p></li>
<li><p><strong>analysis_frames</strong> (Iterable[Iterable[<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>]]) – a running collection storing the <a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a> objects at each frame in time</p></li>
<li><p><strong>sample_rate</strong> (<em>int</em>) – the sampling rate (in samples / s)</p></li>
<li><p><strong>hop_size</strong> (<em>int</em>) – the inter-frame distance (in samples)</p></li>
<li><p><strong>frequency_deviation</strong> (<em>float</em><em>, </em><em>optional</em>) – maximum relative frequency deviation used to constrain peak tracking matches (default: 0.45)</p></li>
<li><p><strong>SMR_continuity</strong> (<em>float</em><em>, </em><em>optional</em>) – percentage of SMR to use in cost calculations during peak tracking (default: 0.0)</p></li>
<li><p><strong>min_gap_length</strong> (<em>int</em>) – tracked partial gaps longer than this (in frames) will not be interpolated (default: 1)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.peak_tracking.phase_interp">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_tracking.</span></span><span class="sig-name descname"><span class="pre">phase_interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pha_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_tracking.html#phase_interp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_tracking.phase_interp" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute linear phase interpolation</p>
<p>NOTE: currently not used in peak tracking, but supplied for legacy purposes</p>
<p>Assumes smooth linear interpolation, where the average frequency dictates phase rate estimate
from the relative time 0 to time t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freq_0</strong> (<em>float</em>) – initial frequency (in Hz)</p></li>
<li><p><strong>freq_t</strong> (<em>float</em>) – frequency at time t (in Hz)</p></li>
<li><p><strong>pha_0</strong> (<em>float</em>) – initial phase (in radians)</p></li>
<li><p><strong>t</strong> (<em>float</em>) – time (in s) from freq_0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the phase (in radians) at relative time t</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.peak_tracking.phase_interp_cubic">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_tracking.</span></span><span class="sig-name descname"><span class="pre">phase_interp_cubic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pha_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pha_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_samps_from_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samps_from_0_to_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_tracking.html#phase_interp_cubic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_tracking.phase_interp_cubic" title="Permalink to this definition"></a></dt>
<dd><p>Function to interpolate phase using cubic polynomial interpolation</p>
<p>Uses cubic interpolation to determine and intermediate phase within the curve linking
a particular frequency and phase at relative time 0, to a frequency and phase at time t.</p>
<p>The basis for this method is credited to:</p>
<blockquote>
<div><p>MR. McAulay and T. Quatieri, “Speech analysis/Synthesis based on a
sinusoidal representation,” in IEEE Transactions on Acoustics,
Speech, and Signal Processing, vol. 34, no. 4, pp. 744-754,
August 1986</p>
<p><a class="reference external" href="https://doi.org/10.1109/TASSP.1986.1164910">doi: 10.1109/TASSP.1986.1164910</a>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freq_0</strong> (<em>float</em>) – initial frequency (in Hz)</p></li>
<li><p><strong>freq_t</strong> (<em>float</em>) – frequency at time t (in Hz)</p></li>
<li><p><strong>pha_0</strong> (<em>float</em>) – initial phase (in radians)</p></li>
<li><p><strong>pha_t</strong> (<em>float</em>) – phase at time t (in radians)</p></li>
<li><p><strong>i_samps_from_0</strong> (<em>int</em>) – relative sample index <cite>i</cite> to interpolate at</p></li>
<li><p><strong>samps_from_0_to_t</strong> (<em>int</em>) – distance (in samples) from 0 to t</p></li>
<li><p><strong>sample_rate</strong> (<em>int</em>) – sampling rate (in samps/s)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the modeled phase (in radians) at sample <cite>i</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.peak_tracking.update_track_averages">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.peak_tracking.</span></span><span class="sig-name descname"><span class="pre">update_track_averages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analysis_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/peak_tracking.html#update_track_averages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.peak_tracking.update_track_averages" title="Permalink to this definition"></a></dt>
<dd><p>Function to update running averages of recent peaks</p>
<p>Using the list of current tracks, we use <cite>track_length</cite> frames to look back and update,
the average amp, frq, and smr values for the tracks.</p>
<p>NOTE: Tracks are updated directly without return value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracks</strong> (Iterable[<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>]) – iterable of tracks to update</p></li>
<li><p><strong>track_length</strong> (<em>int</em>) – how far back in time (in frames) to start average calculations</p></li>
<li><p><strong>frame_n</strong> (<em>int</em>) – the current frame</p></li>
<li><p><strong>analysis_frames</strong> (Iterable[Iterable[<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>]]) – a running collection storing the <a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a> objects at each frame in time</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>optional</em>) – TOadditional bias for the immediately prior frames values when calculating smoothing trajectories (default: 0.0)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyats.atsa.residual">
<span id="residual"></span><h2>residual<a class="headerlink" href="#module-pyats.atsa.residual" title="Permalink to this heading"></a></h2>
<p>TODO Summary</p>
<p>TODO About</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.residual.band_to_energy">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.residual.</span></span><span class="sig-name descname"><span class="pre">band_to_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ats_snd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_smr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/residual.html#band_to_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.residual.band_to_energy" title="Permalink to this definition"></a></dt>
<dd><p>Function to TODO</p>
<p>TODO</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ats_snd</strong> (<a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a>) – TODO</p></li>
<li><p><strong>band_edges</strong> (<em>TODO</em>) – TODO</p></li>
<li><p><strong>use_smr</strong> (<em>bool</em><em>, </em><em>optional</em>) – TODO (default: False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.residual.compute_residual">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.residual.</span></span><span class="sig-name descname"><span class="pre">compute_residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residual_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ats_snd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_sound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/residual.html#compute_residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.residual.compute_residual" title="Permalink to this definition"></a></dt>
<dd><p>Function to computes the difference between the ats_snd synthesis and the original sound</p>
<p>TODO</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>residual_file</strong> (<em>str</em>) – TODO</p></li>
<li><p><strong>ats_snd</strong> (<a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a>) – TODO</p></li>
<li><p><strong>in_sound</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – TODO</p></li>
<li><p><strong>start_sample</strong> (<em>int</em>) – TODO</p></li>
<li><p><strong>end_sample</strong> (<em>int</em>) – TODO</p></li>
<li><p><strong>export_residual</strong> (<em>bool</em><em>, </em><em>optional</em>) – TODO (default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>residual</strong> – TODO</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.residual.remove_bands">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.residual.</span></span><span class="sig-name descname"><span class="pre">remove_bands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ats_snd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/residual.html#remove_bands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.residual.remove_bands" title="Permalink to this definition"></a></dt>
<dd><p>Function TODO</p>
<p>TODO  remove bands from ats_snd that are below threshold (in dB)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ats_snd</strong> (<a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a>) – TODO</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – TODO</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.residual.residual_N">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.residual.</span></span><span class="sig-name descname"><span class="pre">residual_N</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_fft_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/residual.html#residual_N"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.residual.residual_N" title="Permalink to this definition"></a></dt>
<dd><p>Function to TODO</p>
<p>TODO</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>int</em>) – TODO</p></li>
<li><p><strong>min_fft_size</strong> (<em>int</em>) – TODO</p></li>
<li><p><strong>factor</strong> (<em>int</em><em>, </em><em>optional</em>) – TODOe)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TODO</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.residual.residual_analysis">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.residual.</span></span><span class="sig-name descname"><span class="pre">residual_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ats_snd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_fft_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/residual.html#residual_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.residual.residual_analysis" title="Permalink to this definition"></a></dt>
<dd><p>Function to TODO</p>
<p>TODO</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>residual</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – TODO</p></li>
<li><p><strong>ats_snd</strong> (<a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a>) – TODO</p></li>
<li><p><strong>min_fft_size</strong> (<em>int</em><em>, </em><em>optional</em>) – TODO (default: 4096)</p></li>
<li><p><strong>equalize</strong> (<em>bool</em><em>, </em><em>optional</em>) – TODO (default: False)</p></li>
<li><p><strong>pad_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – TODO (default: 2)</p></li>
<li><p><strong>band_edges</strong> (<em>TODO</em>) – TODO (default: None)</p></li>
<li><p><strong>par_energy</strong> (<em>bool</em>) – TODO (default: False)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – TODO (default: True)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.residual.residual_compute_band_energy">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.residual.</span></span><span class="sig-name descname"><span class="pre">residual_compute_band_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fft_mags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/residual.html#residual_compute_band_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.residual.residual_compute_band_energy" title="Permalink to this definition"></a></dt>
<dd><p>Function to TODO</p>
<p>TODO</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fft_mags</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – TODO</p></li>
<li><p><strong>band_limits</strong> (<em>TODO</em>) – TODO</p></li>
<li><p><strong>band_energy</strong> (<em>TODO</em>) – TODO</p></li>
<li><p><strong>frame_n</strong> (<em>int</em>) – TODO</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.residual.residual_get_band_limits">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.residual.</span></span><span class="sig-name descname"><span class="pre">residual_get_band_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fft_mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/residual.html#residual_get_band_limits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.residual.residual_get_band_limits" title="Permalink to this definition"></a></dt>
<dd><p>Function to TODO</p>
<p>TODO</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fft_mag</strong> (<em>float</em>) – TODO</p></li>
<li><p><strong>band_edges</strong> (<em>TODO</em>) – TODO</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>band_limits</strong> – TODO</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TODO</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyats.atsa.tracker">
<span id="tracker"></span><h2>tracker<a class="headerlink" href="#module-pyats.atsa.tracker" title="Permalink to this heading"></a></h2>
<p>Main ATS Analysis Function</p>
<p>The analysis tracker is responsible for driving the analysis of an audio file
into the .ats format. The system uses a Short Time Fourier Transform (STFT) as
is core analysis tool. Sound is analyzed using overlapping time windows and by
taking the STFT on each window.</p>
<p>After converting to polar coordinates, a peak detection algorithm (<code class="xref py py-obj docutils literal notranslate"><span class="pre">peak_detection</span></code>)
determines relevant spectral peaks in the data. At this point, pyschoacoustics
are considered in the form of masking curve evaluation and computation of the
Signal-to-Mask ratio (SMR) for each candidate peak. SMR data is store together with
a corrected frequency, magnitude and phase.</p>
<p>The next step involves frame-to-frame tracking of peaks (<a class="reference internal" href="#module-pyats.atsa.peak_tracking" title="pyats.atsa.peak_tracking"><code class="xref py py-obj docutils literal notranslate"><span class="pre">peak_tracking</span></code></a>) to connect peaks that
follow a similar spectral trajectory using both frequency and SMR data. The system
uses a stable matching algorithm to pair candidate peaks, and is capable of interpolating
gaps in the tracks.</p>
<p>Once valid tracks are assembled, the results can be modeled with sinusoids (<code class="xref py py-obj docutils literal notranslate"><span class="pre">atsa_synth</span></code>) and subtracted
from the origin source sound to compute a residual. NOTE: This part of the ATS system is currently under
active research. For now, the residual analysis (<a class="reference internal" href="#module-pyats.atsa.residual" title="pyats.atsa.residual"><code class="xref py py-obj docutils literal notranslate"><span class="pre">residual</span></code></a>) is modeled using a
25 time-varying critical noise band energy model (consistent with the critical bands used during SMR evaluation).
These noise bands can then be resynthesized using 25 correspoding banks of time-enveloped, band-limited noise.</p>
<p>Analysis is finally stored and abstracted as an <a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a> object.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.tracker.tracker">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.tracker.</span></span><span class="sig-name descname"><span class="pre">tracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ats_snd_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowest_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highest_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency_deviation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_cycles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blackman-harris-4-1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_gap_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_segment_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_peak_contribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SMR_continuity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_amp_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/tracker.html#tracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.tracker.tracker" title="Permalink to this definition"></a></dt>
<dd><p>Function to generates an Analysis-Transformation-Synthesis <a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a> from an audio file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_file</strong> (<em>str</em>) – path to the audio file to analyze (must be single channel/mono)</p></li>
<li><p><strong>ats_snd_label</strong> (<em>str</em>) – internal name for the <a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a></p></li>
<li><p><strong>start</strong> (<em>float</em>) – timepoint (in s) in audiofile to begin analysis (default: 0.0)</p></li>
<li><p><strong>duration</strong> (<em>float</em>) – max duration (in s) in audiofile from start to end analysis or ‘None’ if analyze to end (default: None)</p></li>
<li><p><strong>lowest_frequency</strong> – lowest frequency to analyze (must be &gt; 0) (default: 20)</p></li>
<li><p><strong>highest_frequency</strong> (<em>float</em>) – highest frequency to analyze (capped to nyquist frequency and must be greater than <cite>lowest_frequency</cite>) (default: 20000.0)</p></li>
<li><p><strong>frequency_deviation</strong> (<em>float</em>) – maximum relative frequency deviation used to constrain peak tracking matches (default: 0.1)</p></li>
<li><p><strong>window_cycles</strong> (<em>int</em>) – lowest frequency to fit in analysis window; used to determine window size (default: 4)</p></li>
<li><p><strong>window_type</strong> (<em>str</em>) – type of window to use for FFT analysis (default: ‘blackman-harris-4-1’). See <a class="reference internal" href="#pyats.atsa.windows.VALID_FFT_WINDOW_DEFINITIONS" title="pyats.atsa.windows.VALID_FFT_WINDOW_DEFINITIONS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VALID_FFT_WINDOW_DEFINITIONS</span></code></a></p></li>
<li><p><strong>hop_size</strong> (<em>float</em>) – fraction of window size to shift from frame-to-frame (default: 0.25)</p></li>
<li><p><strong>fft_size</strong> (<em>int</em>) – None, or force an fft size (default: None)</p></li>
<li><p><strong>amp_threshold</strong> (<em>float</em>) – lowest amplitude used for peak detection (default: 0.001)</p></li>
<li><p><strong>track_length</strong> (<em>int</em>) – number of frames used to smooth frequency trajectories (default: 3)</p></li>
<li><p><strong>min_gap_length</strong> (<em>int</em>) – tracked partial gaps longer than this (in frames) will not be interpolated (default: 3)</p></li>
<li><p><strong>min_segment_length</strong> (<em>int</em>) – minimal size (in frames) of a track segment, otherwise it is pruned (default: 3)</p></li>
<li><p><strong>last_peak_contribution</strong> (<em>float</em>) – additional bias for the immediately prior frames values when calculating smoothing trajectories (default: 0.0)</p></li>
<li><p><strong>SMR_continuity</strong> (<em>float</em>) – percentage of SMR to use in cost calculations during peak tracking (default: 0.0)</p></li>
<li><p><strong>residual_file</strong> (<em>str</em>) – path to the audio file used to store residual analysis.
NOTE: noise calculation will not be performed in .ats file without this (default: None)</p></li>
<li><p><strong>optimize</strong> (<em>bool</em>) – whether to perform the post-peak tracking optimization on the <a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a> object (default: True)</p></li>
<li><p><strong>optimize_amp_threshold</strong> (<em>float</em>) – additional amplitude threshold used during optimization to prune tracks (default: None)</p></li>
<li><p><strong>force_M</strong> (<em>int</em>) – None, or a forced window length in samples (default: None)</p></li>
<li><p><strong>force_window</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – None, or a 1D array describing a windowing curve (default: None)</p></li>
<li><p><strong>window_alpha</strong> (<em>float</em>) – parameter used for calculating tukey windows (default: 0.5)</p></li>
<li><p><strong>window_beta</strong> (<em>float</em>) – parameter used for calculating certain window types (default: 1.0)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – increase verbosity (default: False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the ats object that represents the analysis of the input audio file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – if input file is not single channel/mono</p></li>
<li><p><strong>ValueError</strong> – if <cite>lowest_frequency</cite> is &lt; 0.0</p></li>
<li><p><strong>ValueError</strong> – if <cite>highest_frequency</cite> is &lt; <cite>lowest_frequency</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.tracker.tracker_CLI">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.tracker.</span></span><span class="sig-name descname"><span class="pre">tracker_CLI</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/tracker.html#tracker_CLI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.tracker.tracker_CLI" title="Permalink to this definition"></a></dt>
<dd><p>Command line wrapper for <a class="reference internal" href="#pyats.atsa.tracker.tracker" title="pyats.atsa.tracker.tracker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tracker</span></code></a></p>
<p class="rubric">Example</p>
<p>Display usage details with help flag</p>
<blockquote>
<div><p>$ pyats-atsa -h</p>
</div></blockquote>
<p>Analyze a wav file</p>
<blockquote>
<div><p>$ pyats-atsa example.wav example.ats</p>
</div></blockquote>
<p>Analyze a wav file and compute the residual and increase verbosity</p>
<blockquote>
<div><p>$ pyats-atsa example.wav example.ats -v -r example-residual.wav</p>
</div></blockquote>
</dd></dl>

</section>
<section id="module-pyats.atsa.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-pyats.atsa.utils" title="Permalink to this heading"></a></h2>
<p>Utility Functions for ATS Analysis</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.atsa.utils.MAX_DB_SPL">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.utils.</span></span><span class="sig-name descname"><span class="pre">MAX_DB_SPL</span></span><a class="headerlink" href="#pyats.atsa.utils.MAX_DB_SPL" title="Permalink to this definition"></a></dt>
<dd><p>maximum DB_SPL level; used for converting amplitude units</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.atsa.utils.ATS_MIN_SEGMENT_LENGTH">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.utils.</span></span><span class="sig-name descname"><span class="pre">ATS_MIN_SEGMENT_LENGTH</span></span><a class="headerlink" href="#pyats.atsa.utils.ATS_MIN_SEGMENT_LENGTH" title="Permalink to this definition"></a></dt>
<dd><p>default minimum segment length</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.atsa.utils.ATS_AMP_THRESHOLD">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.utils.</span></span><span class="sig-name descname"><span class="pre">ATS_AMP_THRESHOLD</span></span><a class="headerlink" href="#pyats.atsa.utils.ATS_AMP_THRESHOLD" title="Permalink to this definition"></a></dt>
<dd><p>default amp threshold</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.atsa.utils.ATS_NOISE_THRESHOLD">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.utils.</span></span><span class="sig-name descname"><span class="pre">ATS_NOISE_THRESHOLD</span></span><a class="headerlink" href="#pyats.atsa.utils.ATS_NOISE_THRESHOLD" title="Permalink to this definition"></a></dt>
<dd><p>default noise threshold</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.utils.amp_to_db">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.utils.</span></span><span class="sig-name descname"><span class="pre">amp_to_db</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/utils.html#amp_to_db"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.utils.amp_to_db" title="Permalink to this definition"></a></dt>
<dd><p>Function to convert amplitude to decibels: <span class="math notranslate nohighlight">\(20 * \log_{10}{amp}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>amp</strong> (<em>float</em>) – an amplitude value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the converted decibel value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.utils.amp_to_db_spl">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.utils.</span></span><span class="sig-name descname"><span class="pre">amp_to_db_spl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/utils.html#amp_to_db_spl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.utils.amp_to_db_spl" title="Permalink to this definition"></a></dt>
<dd><p>Function to convert amplitude to decibel sound pressure level (dB SPL)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>amp</strong> (<em>float</em>) – an amplitude value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the converted dB SPL value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.utils.compute_frames">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.utils.</span></span><span class="sig-name descname"><span class="pre">compute_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_samps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/utils.html#compute_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.utils.compute_frames" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute the number frames to use in the specified analysis.</p>
<p>Calculates an extra frame to prevent attenuation during windowing at the tail and to allow
for interpolation at the end of the soundfile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_samps</strong> (<em>int</em>) – number of samples in analyzed sound duration</p></li>
<li><p><strong>hop</strong> (<em>int</em>) – interframe distance in samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of frames to use for STFT analysis</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.utils.db_to_amp">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.utils.</span></span><span class="sig-name descname"><span class="pre">db_to_amp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/utils.html#db_to_amp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.utils.db_to_amp" title="Permalink to this definition"></a></dt>
<dd><p>Function to convert decibels to amplitude: <span class="math notranslate nohighlight">\(10^{dB / 20.0}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>db</strong> (<em>float</em>) – a decibel value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the converted amplitude value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.utils.next_power_of_2">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.utils.</span></span><span class="sig-name descname"><span class="pre">next_power_of_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/utils.html#next_power_of_2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.utils.next_power_of_2" title="Permalink to this definition"></a></dt>
<dd><p>Function to return the closest power of 2 integer more than or equal to an input</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num</strong> (<em>int</em>) – a positive integer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the closest power of 2 integer more than or equal to <cite>num</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.utils.optimize_tracks">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.utils.</span></span><span class="sig-name descname"><span class="pre">optimize_tracks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analysis_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_segment_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highest_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowest_frequency</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/utils.html#optimize_tracks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.utils.optimize_tracks" title="Permalink to this definition"></a></dt>
<dd><p>Function to run optimization routines on the established tracks.</p>
<dl class="simple">
<dt>The optimizations performed are:</dt><dd><ul class="simple">
<li><p>trim short partials</p></li>
<li><p>calculate and store maximum and average frq and amp</p></li>
<li><p>prune tracks below amplitude threshold</p></li>
<li><p>prune tracks outside frequency constraints</p></li>
<li><p>sort and renumber tracks and peaks in analysis_frames according to average frq</p></li>
</ul>
</dd>
</dl>
<p>NOTE: directly updates analysis_frames, pruning peaks corresponding to pruned tracks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracks</strong> (Iterable[<a class="reference internal" href="#pyats.ats_structure.AtsSound" title="pyats.ats_structure.AtsSound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsSound</span></code></a>]) – collection of established tracks</p></li>
<li><p><strong>analysis_frames</strong> (Iterable[Iterable[<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a>]]) – a collection storing the <a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtsPeak</span></code></a> objects at each frame in time</p></li>
<li><p><strong>min_segment_length</strong> (<em>int</em>) – minimal size (in frames) of a valid track segment, otherwise it is pruned</p></li>
<li><p><strong>amp_threshold</strong> (<em>float</em>) – amplitude threshold used to prune tracks. If None, will default to <a class="reference internal" href="#pyats.atsa.utils.ATS_AMP_THRESHOLD" title="pyats.atsa.utils.ATS_AMP_THRESHOLD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ATS_AMP_THRESHOLD</span></code></a> converted to amplitude.</p></li>
<li><p><strong>highest_frequency</strong> (<em>float</em>) – upper frequency threshold, tracks with maxima above this will be pruned</p></li>
<li><p><strong>lowest_frequency</strong> (<em>float</em>) – lower frequency threshold, tracks with minima below this will be pruned</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>tracks</strong> – the optimized subset of input tracks</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Iterable[<a class="reference internal" href="#pyats.ats_structure.AtsPeak" title="pyats.ats_structure.AtsPeak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyats.ats_structure.AtsPeak</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyats.atsa.windows">
<span id="windows"></span><h2>windows<a class="headerlink" href="#module-pyats.atsa.windows" title="Permalink to this heading"></a></h2>
<p>Functions to Generate FFT Windows</p>
<p>A collection of window utilies to generate several useful window types:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>blackman-exact</p></td>
<td><p>kaiser</p></td>
<td><p>cauchy</p></td>
</tr>
<tr class="row-even"><td><p>blackman</p></td>
<td><p>gaussian</p></td>
<td><p>connes</p></td>
</tr>
<tr class="row-odd"><td><p>blackman-harris-3-1</p></td>
<td><p>poisson</p></td>
<td><p>exponential</p></td>
</tr>
<tr class="row-even"><td><p>blackman-harris-3-2</p></td>
<td><p>cauchy</p></td>
<td><p>bartlett</p></td>
</tr>
<tr class="row-odd"><td><p>blackman-harris-4-1</p></td>
<td><p>connes</p></td>
<td><p>riemann</p></td>
</tr>
<tr class="row-even"><td><p>blackman-harris-4-2</p></td>
<td><p>welch</p></td>
<td><p>tukey</p></td>
</tr>
<tr class="row-odd"><td><p>rectangular</p></td>
<td><p>kaiser</p></td>
<td><p>hamming</p></td>
</tr>
<tr class="row-even"><td><p>parzen</p></td>
<td><p>gaussian</p></td>
<td><p>hann</p></td>
</tr>
<tr class="row-odd"><td><p>welch</p></td>
<td><p>poisson</p></td>
<td><p>hann-poisson</p></td>
</tr>
</tbody>
</table>
<p>Most equations are adapted from the following two papers:</p>
<p>F. J. Harris, “On the use of windows for harmonic analysis with the
discrete Fourier transform,” in Proceedings of the IEEE, vol. 66,
no. 1, pp. 51-83, Jan. 1978.</p>
<blockquote>
<div><p><a class="reference external" href="https://doi.org/10.1109/PROC.1978.10837">doi: 10.1109/PROC.1978.10837</a>.</p>
</div></blockquote>
<p>A. Nuttall, “Some windows with very good sidelobe behavior,” in IEEE
Transactions on Acoustics, Speech, and Signal Processing, vol. 29,
no. 1, pp. 84-91, February 1981</p>
<blockquote>
<div><p><a class="reference external" href="https://doi.org/10.1109/TASSP.1981.1163506">doi: 10.1109/TASSP.1981.1163506</a>.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.atsa.windows.VALID_FFT_WINDOW_DEFINITIONS">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.windows.</span></span><span class="sig-name descname"><span class="pre">VALID_FFT_WINDOW_DEFINITIONS</span></span><a class="headerlink" href="#pyats.atsa.windows.VALID_FFT_WINDOW_DEFINITIONS" title="Permalink to this definition"></a></dt>
<dd><p>a list of supported window types</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyats.atsa.windows.ATS_BLACKMAN_WINDOW_COEFF_LABELS">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.windows.</span></span><span class="sig-name descname"><span class="pre">ATS_BLACKMAN_WINDOW_COEFF_LABELS</span></span><a class="headerlink" href="#pyats.atsa.windows.ATS_BLACKMAN_WINDOW_COEFF_LABELS" title="Permalink to this definition"></a></dt>
<dd><p>A dictionary to match blackman window type strings to their coefficients</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict[str : list[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.windows.bes_i0">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.windows.</span></span><span class="sig-name descname"><span class="pre">bes_i0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/windows.html#bes_i0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.windows.bes_i0" title="Permalink to this definition"></a></dt>
<dd><p>Modified Bessel Function of the First Kind from “Numerical Recipes in C”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>float</em>) – Bessel function input</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bessel function output</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.windows.make_blackman_window">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.windows.</span></span><span class="sig-name descname"><span class="pre">make_blackman_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/windows.html#make_blackman_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.windows.make_blackman_window" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to build Blackman windows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_type</strong> (<em>str</em>) – the type of blackman window (supported types are defined in <code class="xref py py-obj docutils literal notranslate"><span class="pre">ATS_BLACKMAN_WINDOW_COEFF_LABELS)</span></code></p></li>
<li><p><strong>size</strong> (<em>int</em>) – the size of the window to generate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a 1D array of floats representing the window</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.windows.make_fft_window">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.windows.</span></span><span class="sig-name descname"><span class="pre">make_fft_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/windows.html#make_fft_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.windows.make_fft_window" title="Permalink to this definition"></a></dt>
<dd><p>Function to build the specified window</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_type</strong> (<em>str</em>) – the type of window (supported types are defined in <a class="reference internal" href="#pyats.atsa.windows.VALID_FFT_WINDOW_DEFINITIONS" title="pyats.atsa.windows.VALID_FFT_WINDOW_DEFINITIONS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VALID_FFT_WINDOW_DEFINITIONS</span></code></a>)</p></li>
<li><p><strong>size</strong> (<em>int</em>) – the size of the window to generate</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>optional</em>) – parameter used in certain window calculations (float: 1.0)</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – parameter used in tukey window calculation (float: 0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a 1D array of floats representing the window</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <cite>window_type</cite> is not one of the supported window types in <a class="reference internal" href="#pyats.atsa.windows.VALID_FFT_WINDOW_DEFINITIONS" title="pyats.atsa.windows.VALID_FFT_WINDOW_DEFINITIONS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">VALID_FFT_WINDOW_DEFINITIONS</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.windows.normalize_window">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.windows.</span></span><span class="sig-name descname"><span class="pre">normalize_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/windows.html#normalize_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.windows.normalize_window" title="Permalink to this definition"></a></dt>
<dd><p>Function to normalize a window</p>
<p>Normalization here means that the window will integrate to 1.0 (i.e., total area of 1)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>window</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – the window to normalize</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a normalized version of the input window</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyats.atsa.windows.window_norm">
<span class="sig-prename descclassname"><span class="pre">pyats.atsa.windows.</span></span><span class="sig-name descname"><span class="pre">window_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyats/atsa/windows.html#window_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyats.atsa.windows.window_norm" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute the norm of a window</p>
<p><span class="math notranslate nohighlight">\(norm = \frac{1}{\sum | x |}\)</span> where <span class="math notranslate nohighlight">\(x\)</span> are the window samples</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>window</strong> (<em>ndarray</em><em>[</em><em>float</em><em>]</em>) – TODO</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the norm of the window</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="info.html" class="btn btn-neutral float-left" title="Information about ATS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Johnathan G Lyon.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>